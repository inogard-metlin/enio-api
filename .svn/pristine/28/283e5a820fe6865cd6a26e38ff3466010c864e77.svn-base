package kr.co.inogard.enio.api.rfq;

import java.util.HashMap;
import java.util.Map;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.modelmapper.ModelMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.SpringApplicationConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.transaction.annotation.Transactional;
import kr.co.inogard.enio.api.Application;
import kr.co.inogard.enio.api.commons.handler.EnioValidateHandler;
import kr.co.inogard.enio.api.commons.util.RestTemplateFactory;
import kr.co.inogard.enio.api.domain.rfq.Rfq;
import kr.co.inogard.enio.api.service.rfq.RfqService;
import lombok.extern.slf4j.Slf4j;

@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = Application.class)
@WebAppConfiguration
@Transactional
@Slf4j
public class RfqServiceTest {

  @Autowired
  RfqService rfqService;

  @Autowired
  ModelMapper modelMapper;

  @Autowired
  RestTemplateFactory restTemplateFactory;

  @Autowired
  EnioValidateHandler enioValidateHandler;

  @Value("${enio.agent.context-path}/${enio.agent.version}${enio.agent.uri-path.pr}")
  private String prUriPath;

  @Test
  public void test() {
    log.debug("agentVersion : {}", prUriPath);
  }

  @Test
  public void createFromPrText() {
    String prNo = "S0001102017111300002";

    Map<String, String> prInfo = new HashMap<String, String>();
    prInfo.put("prNo", prNo);
    prInfo.put("bidSubTypecd", "4");
    prInfo.put("bidTypecd", "1");

    Rfq rfq = rfqService.createFromPr(prInfo);
    log.debug("new-rfq-no=:{}", rfq.getRfqNo());
  }

}
